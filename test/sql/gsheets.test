# name: test/sql/gsheets.test
# description: test gsheets extension
# group: [gsheets]

# Before we load the extension, this will fail
statement error
FROM read_gsheet('11QdEasMWbETbFVxry-SsD8jVcdYIT1zBQszcF84MdE8', 'token.txt', header=true);
----
Catalog Error: Table Function with name read_gsheet does not exist!

# Require statement will ensure this test is run with this extension loaded
require gsheets

# Confirm the extension works
query III
FROM read_gsheet('11QdEasMWbETbFVxry-SsD8jVcdYIT1zBQszcF84MdE8', 'token.txt', header=true);
----
Alice	30	Toronto
Bob	25	New York
Charlie	45	Chicago
Drake	NULL	NULL
NULL	NULL	NULL
Archie	99	NULL

# Test the full URL
query III
FROM read_gsheet('https://docs.google.com/spreadsheets/d/11QdEasMWbETbFVxry-SsD8jVcdYIT1zBQszcF84MdE8/edit#gid=0', 'token.txt', header=true);
----
Alice	30	Toronto
Bob	25	New York
Charlie	45	Chicago
Drake	NULL	NULL
NULL	NULL	NULL
Archie	99	NULL